{
    "description": "Pipeline for normalizing MISP threat",
    "processors": [
      {
        "geoip": {
          "field": "destination.ip",
          "target_field": "destination.geo",
          "ignore_missing": true
        }
      },
      {
        "geoip": {
          "field": "source.ip",
          "target_field": "source.geo",
          "ignore_missing": true
        }
      },
      {
        "set": {
          "field": "_id",
          "value": "{{misp.threat_indicator.uuid}}"
        }
      }
    ],
    "on_failure" : [{ 
      "set" : { 
        "field" : "error.message", 
        "value" : "{{ _ingest.on_failure_message }}" 
      } 
    }]
  }
  